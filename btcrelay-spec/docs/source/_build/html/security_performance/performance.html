

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Performance and Costs &mdash; Polkadot BTC-Relay 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="License" href="../other/license.html" />
    <link rel="prev" title="Security Analysis" href="security.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: grey" >
          

          
            <a href="../index.html" class="icon icon-home"> Polkadot BTC-Relay
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/at-a-glance.html">BTC-Relay at a Glance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/bitcoin.html">Bitcoin Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/architecture.html">BTC-Relay Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spec/data-model.html">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spec/functions.html">Functions: Storage and Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spec/helpers.html">Functions: Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spec/parser.html">Functions: Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spec/events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spec/errors.html">Error Codes</a></li>
</ul>
<p class="caption"><span class="caption-text">Security and Performance</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="security.html">Security Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance and Costs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#estimation-of-storage-costs">Estimation of Storage Costs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#btc-relay-optimizations">BTC-Relay Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pruning">Pruning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-submissions">Batch Submissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outlook-on-sub-linear-verification-in-bitcoin">Outlook on Sub-Linear Verification in Bitcoin</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">All the rest</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../other/license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Polkadot BTC-Relay</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Performance and Costs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/security_performance/performance.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="performance-and-costs">
<h1>Performance and Costs<a class="headerlink" href="#performance-and-costs" title="Permalink to this headline">¶</a></h1>
<p>Contrary to permissionless blockchains, such as Ethereum, Polkadot’s Parachains can easily implement the cryptographic primitives of the interlinked blockchains, instead of relying on pre-compiled smart contracts or manual and costly implementation of primitives.
In the case of Bitcoin, the BTC Parachain can provide native support for the SHA256 and RIPEMD-160 hash functions, as well as for ECDSA using the <a class="reference external" href="https://en.bitcoin.it/wiki/Secp256k1">secp256k1</a> Koblitz curve.</p>
<p>Consequently, storage resembles the main cost factor of BTC-Relay on Polkadot.</p>
<div class="section" id="estimation-of-storage-costs">
<h2>Estimation of Storage Costs<a class="headerlink" href="#estimation-of-storage-costs" title="Permalink to this headline">¶</a></h2>
<p>BTC-Relay only stores Bitcoin block headers. Transactions are not stored directly in the relay – this responsibility lies with other components interacting with the verification component.</p>
<p>The size of the necessary storage allocation hence grows linear with the lenght of the Bitcoin blockchain, tracked in BTC-Relay – specifically, the block headers stored in <code class="docutils literal notranslate"><span class="pre">BlockHeaders</span></code> which are referenced in <code class="docutils literal notranslate"><span class="pre">MainChain</span></code> or in an entry of <code class="docutils literal notranslate"><span class="pre">Forks</span></code>.</p>
<p>Recall, for each block headers, BTC-Relay merely stores:</p>
<ul class="simple">
<li><p>the 32 byte <code class="docutils literal notranslate"><span class="pre">blockHash</span></code></p></li>
<li><p>4 byte <code class="docutils literal notranslate"><span class="pre">blockHeight</span></code> (twice for better referencing, so 8 bytes in total)</p></li>
<li><p>and the 32 byte <code class="docutils literal notranslate"><span class="pre">merkleRoot</span></code></p></li>
</ul>
<p>That is, in total 72 bytes per submitted Bitcoin block header (fork or main chain block).</p>
<p>At the current block height of <strong>607515</strong>, the storage requirements would amount to around <strong>44 MB</strong> – an arguably negligible number.</p>
</div>
<div class="section" id="btc-relay-optimizations">
<h2>BTC-Relay Optimizations<a class="headerlink" href="#btc-relay-optimizations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pruning">
<h3>Pruning<a class="headerlink" href="#pruning" title="Permalink to this headline">¶</a></h3>
<p>Optionally, to further reduce storage requirements (e.g., in case more data is to be stored per block in the future), <em>pruning</em> of <code class="docutils literal notranslate"><span class="pre">MainChain</span></code> and <code class="docutils literal notranslate"><span class="pre">BlockHeaders</span></code> can be introduced.
While the storage overhead for Bitcoin itself may be acceptable, Polkadot is exepcted to connect to numerous blockchains and tracking the entire blockchain history for each could unnecessarily bloat Parachains (even more so, if parachains are non-exclusive to specific blockchains).</p>
<p>With pruning activated, <code class="docutils literal notranslate"><span class="pre">MainChain</span></code> would be implemented as a FIFO queue, where sufficiently old block headers are removed from <code class="docutils literal notranslate"><span class="pre">BlockHeaders</span></code> (and the references from <code class="docutils literal notranslate"><span class="pre">MainChain</span></code> and <code class="docutils literal notranslate"><span class="pre">Forks</span></code> accordingly).
The pruning depth can be set to e.g. 10 000 blocks. There is no need to store more block headers, as verification of transactions contained in older blocks can still be performed by requiring users to <em>re-spend</em>.
More detailed analysis of the spending behaviour in Bitcoin, i.e., UTXOs of which age are spent most frequently and at which “depth” the spending behavior declines, can be considered to optimize the cost reduction.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If pruning is implemented for <code class="docutils literal notranslate"><span class="pre">BlockHeaders</span></code> and <code class="docutils literal notranslate"><span class="pre">MainChain</span></code> as performance optimization, it is critical to make sure there are no <code class="docutils literal notranslate"><span class="pre">Forks</span></code> entries left which reference pruned blocks. Either delay pruning, or, if the fork is inactive (hash falled behind <code class="docutils literal notranslate"><span class="pre">MainChain</span></code> at least <em>k</em> blocks), delete it as well.</p>
</div>
</div>
<div class="section" id="batch-submissions">
<h3>Batch Submissions<a class="headerlink" href="#batch-submissions" title="Permalink to this headline">¶</a></h3>
<p>Currently, BTC-Relay supports submissions of a single Bitcoin block header per transaction.</p>
<p>To reduce network load on the Parachain, mulitple block header submissions can be batched into a single transaction.
Note: the improvement in terms of data broadcast to the Parachain depends on the fixed costs per Parachain transaction (if Parachain transactions are considered a negligible cost, batching may be unnecessary).</p>
<p>The potential improvement can especially be useful for blockchains with higher block generation rates than Bitcoin’s 1 block / 10 minutes.</p>
</div>
<div class="section" id="outlook-on-sub-linear-verification-in-bitcoin">
<h3>Outlook on Sub-Linear Verification in Bitcoin<a class="headerlink" href="#outlook-on-sub-linear-verification-in-bitcoin" title="Permalink to this headline">¶</a></h3>
<p>Recently, so called <a href="#id1"><span class="problematic" id="id2">*</span></a>sub-linear’ light clients were proposed for Bitcoin, which use random sampling of blocks to deter malicious actors from tricking light clients into accepting an invalid chain.</p>
<p>We refer the reader to the <a class="reference external" href="https://eprint.iacr.org/2017/963.pdf">Superblock NiPoPoW</a> and the <a class="reference external" href="https://eprint.iacr.org/2019/226.pdf">FlyClient</a> papers for more details.</p>
<p>As of this writing, both techniques require soft fork modifications to Bitcoin, if to be deployed in a secure and useful manner.
The design of BTC-Relay as specified in this document (split into storage, verification, parser, etc. components) thereby allows for introduction of additional verification methods, without major modifications to the architecture.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../other/license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="security.html" class="btn btn-neutral float-left" title="Security Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Interlay

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>